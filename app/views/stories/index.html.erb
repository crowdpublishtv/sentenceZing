<h1>Stories</h1>

<div class="row" >
  <div class="col-md-3 col-sm-3 col-xs-3 " style="text-align:left">
    TITLE
  </div>
  <div class="col-md-3 col-sm-3 col-xs-3 " style="text-align:left">
    CATEGORY
  </div>
  <div class="col-md-3 col-sm-3 col-xs-3 " style="text-align:left">
    ACTION
  </div>
  <div class="col-md-3 col-sm-3 col-xs-3 " style="text-align:left">
    LIKES
  </div>
</div>

<% @stories.each do |story| %>
  <div class="row" >
    <div class="col-md-3 col-sm-3 col-xs-3 " style="text-align:left">
      <% if story.microposts.any? %>
        <%= link_to(story.title, story_path(story), :rel => 'shadowbox[stories];width=1300;height=600;') %>
      <% else %>
        <%= story.title %>
      <% end %>
    </div>

    <div class="col-md-3 col-sm-3 col-xs-3 " style="text-align:left">
      <%= story.category %>
    </div>

    <div class="col-md-3 col-sm-3 col-xs-3 " style="text-align:left">
      <% if current_user.id == story.user_id || current_user.id == story.user2id %>
        <% if current_user.id == story.turn %>
          <%= link_to 'Waiting', edit_story_path(story) %>
        <% else%>
          <%= link_to 'Your Turn', edit_story_path(story) %>
        <% end %>      
      <% elsif story.user2id == nil || story.user2id == 0 %>
        <%= form_for(story) do |f| %>
          <%= f.hidden_field :user2id, :value => 0 %>
          <%= f.submit 'Join Story' %>
      <% end %>
      <% else %> 
        <%= link_to 'Read Story', edit_story_path(story) %>
      <% end %>
    </div>

    <div class="col-md-3 col-sm-3 col-xs-3 " style="text-align:left">
      <%= Like.where(:story_id => story.id).count %> Likes
    </div>

  </div>
<% end %>
<br>

<%= link_to 'New Story', new_story_path %>
